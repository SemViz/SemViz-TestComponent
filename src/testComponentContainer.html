<template id="testComponentContainer-template">
  <div class="testComponentContainer-container">
    I am a Container of test-component
    <test-component></test-component>
  </div>
  <!--<link rel="import" href="./testComponent.html">-->
  <!--<link id="test-component" rel="import" href="https://raw.githubusercontent.com/assemblee-virtuelle/SemViz-TestComponent/master/src/testComponent.html">-->

  <style>
    .testComponentContainer-container{
      background-color: Green ;
      margin: 5px;
      padding: 5px;
    }

  </style>
</template>
<script>
  console.log(document.currentScript);
  //document.currentScript.ownerDocument;
  class testComponentContainer extends HTMLElement {
    constructor(postal) {
      super();
      this.postal = postal;
    }

    connectedCallback() {
      const shadowRoot = this.attachShadow({
        mode: 'open'
      });
      //const template = document.querySelector('#test-component-container').import.querySelector('#testComponentContainer-template');
      const templateCandidates = document.querySelectorAll('link[rel=import]');
      let template=null;
      for (let templateCandidate of templateCandidates) {
        template=templateCandidate.import.querySelector('#testComponentContainer-template')
        if(template!=null){
          break;
        }
      }

      const instance = template.content.cloneNode(true);
      shadowRoot.appendChild(instance);
    }
  }

  let componentDependecies=[
    {
      url:'https://raw.githubusercontent.com/assemblee-virtuelle/SemViz-TestComponent/master/src/testComponent.html',
      id:'test-component'
    }
  ]

  for (let componentDependecy of componentDependecies) {
    console.log(document.querySelector('#'+componentDependecy.id));
    if(document.querySelector('#'+componentDependecy.id)==null){
      console.log('ALLO');
      let importFile = document.createElement('link');
      importFile.rel = 'import';
      importFile.href = componentDependecy.url;
      importFile.id = componentDependecy.id;
      console.log(importFile);
      document.head.appendChild(importFile);
    }
  }

  customElements.define('test-component-container', testComponentContainer);
</script>
